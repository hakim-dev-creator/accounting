 <!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙˆØ§ØªØ¨ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #1976D2; --success: #388E3C; --danger: #D32F2F; --warning: #FFA000; --purple: #7B1FA2; --dark: #333; --light: #f5f5f5; }
        body { font-family: 'Tajawal', sans-serif; background-color: #f0f2f5; margin: 0; user-select: none; -webkit-user-select: none; padding-bottom: 20px; }
        
        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .header { background: white; padding: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 100; }
        .app-title { margin: 0; color: var(--primary); font-size: 1.4rem; font-weight: 800; }
        
        /* Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø´Ù‡Ø± */
        .month-ctrl { background: white; margin: 15px; padding: 10px; border-radius: 12px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .btn-nav { background: none; border: none; font-size: 1.5rem; color: var(--dark); cursor: pointer; }
        
        /* Ø§Ù„Ø¬Ø¯ÙˆÙ„ */
        .grid-container { padding: 0 15px; }
        #calendarGrid { display: grid; background: #cfd8dc; gap: 1px; border: 1px solid #b0bec5; border-radius: 8px; overflow: auto; max-height: 55vh; }
        #calendarGrid > div { background: white; display: flex; align-items: center; justify-content: center; padding: 10px 5px; min-height: 45px; font-size: 0.9rem; }
        .emp-name { position: sticky; right: 0; background: #f8f9fa !important; font-weight: bold; border-left: 2px solid #ddd; z-index: 10; color: var(--primary); }
        
        /* Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø­Ø¶ÙˆØ± */
        .st-present { background: #E8F5E9 !important; color: var(--success); font-weight: bold; }
        .st-absent { background: #FFEBEE !important; color: var(--danger); font-weight: bold; }
        
        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³ÙÙ„ÙŠØ© (Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙƒØ¨ÙŠØ±Ø© Ø§Ù„Ù…Ù„ÙˆÙ†Ø©) */
        .main-menu { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 15px; }
        .menu-btn { border: none; color: white; padding: 15px; border-radius: 12px; font-family: 'Tajawal'; font-size: 1rem; font-weight: bold; display: flex; align-items: center; justify-content: center; gap: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); cursor: pointer; }
        .btn-purple { background: var(--purple); }
        .btn-blue { background: var(--primary); }
        .btn-grey { background: #546E7A; }
        .btn-green { background: var(--success); }
        .btn-red { background: var(--danger); }
        
        /* Ø§Ù„Ù†ÙˆØ§ÙØ° */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; justify-content: center; align-items: center; backdrop-filter: blur(3px); }
        .modal-content { background: white; width: 90%; max-width: 400px; padding: 20px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); animation: popUp 0.3s ease; max-height: 90vh; overflow-y: auto; }
        @keyframes popUp { from {transform: scale(0.9); opacity: 0;} to {transform: scale(1); opacity: 1;} }
        
        /* Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø®Ø§ØµØ© (ÙƒÙ…Ø§ ÙÙŠ Ø§Ù„ØµÙˆØ±) */
        .purple-box { background: #F3E5F5; padding: 10px; border-radius: 10px; border: 1px solid #E1BEE7; margin-bottom: 15px; }
        .input-group { display: flex; gap: 10px; margin-bottom: 10px; }
        input, select { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-family: 'Tajawal'; font-size: 1rem; box-sizing: border-box; }
        
        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª */
        .btn-action { width: 100%; padding: 14px; border: none; border-radius: 10px; color: white; font-weight: bold; font-size: 1rem; margin-bottom: 10px; cursor: pointer; }
        .btn-outline { background: white; border: 2px solid #ddd; color: #555; }
        
        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¯ÙŠÙˆÙ† */
        .tabs { display: flex; gap: 10px; margin-bottom: 15px; }
        .tab-btn { flex: 1; padding: 10px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }
        .tab-active-in { background: var(--success); color: white; }
        .tab-active-out { background: var(--danger); color: white; }
        .tab-inactive { background: #eee; color: #777; }
        
        .debt-list-item { background: white; padding: 12px; margin-bottom: 8px; border-radius: 10px; border: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; }
        .total-bar { background: #333; color: white; padding: 12px; border-radius: 8px; margin: 10px 0; text-align: center; font-weight: bold; font-size: 1.1rem; }
        
        /* Ù‚Ø³Ù… Ø§Ù„Ø­Ø°Ù Ø§Ù„ÙˆØ±Ø¯ÙŠ */
        .delete-manager { background: #FFEBEE; border: 2px dashed #EF9A9A; padding: 15px; border-radius: 12px; margin-top: 20px; }
        .delete-title { color: var(--danger); font-weight: bold; margin-bottom: 10px; display: flex; align-items: center; gap: 5px; }
    </style>
</head>
<body>

    <div id="contentArea" style="display:none; flex-direction: column; min-height: 100vh;">
        <div class="header">
            <h1 class="app-title">Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ÙˆØ§ØªØ¨</h1>
            <button onclick="openSettings()" style="background:none;border:none;font-size:1.5rem">âš™ï¸</button>
        </div>

        <div class="month-ctrl">
            <button class="btn-nav" onclick="changeMonth(-1)">â—€</button>
            <h3 id="monthLabel" style="margin:0;color:var(--primary)"></h3>
            <button class="btn-nav" onclick="changeMonth(1)">â–¶</button>
        </div>

        <div class="grid-container">
            <div id="calendarGrid"></div>
        </div>

        <div style="flex:1"></div>

        <div class="main-menu">
            <button class="menu-btn btn-purple" onclick="openReportModal()">ğŸ“œ Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ±</button>
            <button class="menu-btn btn-blue" onclick="openAdvances()">ğŸ’¸ Ø§Ù„ØªØ³Ø¨ÙŠÙ‚Ø§Øª</button>
            <button class="menu-btn btn-grey" onclick="openSettings()">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
            <button class="menu-btn btn-green" onclick="printReport()">ğŸ–¨ ØªÙ‚Ø±ÙŠØ± PDF</button>
            <button class="menu-btn btn-red" style="grid-column: span 2" onclick="openDebts()">ğŸ“’ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯ÙŠÙˆÙ†</button>
        </div>
    </div>

    <div id="attModal" class="modal">
        <div class="modal-content" style="text-align:center">
            <h2 id="attEmpName" style="color:var(--primary); margin-top:0"></h2>
            
            <div class="purple-box">
                <label style="display:block;text-align:right;font-size:0.9rem;color:#6A1B9A;margin-bottom:5px">Ø§Ù„Ø£Ø¬Ø± Ø§Ù„ÙŠÙˆÙ…ÙŠ Ù„Ù‡Ø°Ø§ Ø§Ù„Ø¹Ø§Ù…Ù„:</label>
                <div style="display:flex;gap:5px">
                    <button style="background:#AB47BC;color:white;border:none;padding:0 15px;border-radius:6px">ØªØ­Ø¯ÙŠØ«</button>
                    <input type="number" id="currentRateInput" style="text-align:center;font-weight:bold">
                </div>
            </div>

            <div style="text-align:right;margin-bottom:5px;font-weight:bold;color:#555">ÙˆÙ‚Øª Ø§Ù„Ø­Ø¶ÙˆØ±:</div>
            <div class="input-group">
                <button onclick="setNow()" style="background:#FFA000;color:white;border:none;border-radius:6px;padding:0 15px;font-weight:bold">Ø§Ù„Ø¢Ù†</button>
                <input type="time" id="tIn" style="font-size:1.2rem;text-align:center">
            </div>

            <button onclick="saveAtt('present')" class="btn-action btn-blue">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</button>
            <button onclick="saveAtt('absent')" class="btn-action btn-red">ØªØ³Ø¬ÙŠÙ„ ØºÙŠØ§Ø¨</button>
            <button onclick="closeModal('attModal')" class="btn-action btn-outline">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
    </div>

    <div id="debtsModal" class="modal">
        <div class="modal-content">
            <h3 style="text-align:center;margin-top:0">ğŸ“’ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯ÙŠÙˆÙ†</h3>
            
            <div class="tabs">
                <button id="tabIn" onclick="switchDebtTab('in')" class="tab-btn tab-active-in">Ø¯ÙŠÙˆÙ† Ù„Ù„ØªØ­ØµÙŠÙ„</button>
                <button id="tabOut" onclick="switchDebtTab('out')" class="tab-btn tab-inactive">Ø¯ÙŠÙˆÙ† Ù„Ù„ØªØ³Ø¯ÙŠØ¯</button>
            </div>

            <div class="input-group">
                <input id="debtVal" type="number" placeholder="Ø§Ù„Ù…Ø¨Ù„Øº" style="flex:1">
                <input id="debtName" list="namesList" placeholder="Ø§Ù„Ø§Ø³Ù…" style="flex:1">
            </div>
            <button id="btnAddDebt" onclick="addDebt()" class="btn-action btn-green">Ø¥Ø¶Ø§ÙØ©</button>

            <div id="debtListArea" style="max-height:200px;overflow-y:auto;margin-bottom:10px"></div>
            <div class="total-bar">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: <span id="debtTotal">0</span></div>

            <div class="delete-manager">
                <div class="delete-title">ğŸ—‘ï¸ Ù…Ø¯ÙŠØ± Ø§Ù„Ø­Ø°Ù</div>
                <label>Ù†ÙˆØ¹ Ø§Ù„Ø¯ÙŠÙ†:</label>
                <select id="delTypeSelect" onchange="refreshDelList()" style="background:white;margin-bottom:10px">
                    <option value="in">Ø¯ÙŠÙˆÙ† Ù„Ù„ØªØ­ØµÙŠÙ„</option>
                    <option value="out">Ø¯ÙŠÙˆÙ† Ù„Ù„ØªØ³Ø¯ÙŠØ¯</option>
                </select>
                <label>Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù…ÙŠÙ„:</label>
                <select id="delClientSelect" onchange="refreshDelList()" style="background:white;margin-bottom:10px"></select>
                
                <div style="display:flex;gap:10px;margin-top:10px">
                    <button onclick="deleteSelectedDebts()" class="btn-action btn-red" style="margin:0;font-size:0.9rem">Ø­Ø°Ù Ø§Ù„Ù…Ø­Ø¯Ø¯</button>
                    <button onclick="selectAllDebts()" class="btn-action btn-blue" style="margin:0;font-size:0.9rem">ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙƒÙ„ âœ”</button>
                </div>
                <div id="delCheckList" style="max-height:100px;overflow-y:auto;margin-top:5px;background:white;padding:5px;border-radius:5px"></div>
            </div>

            <button onclick="closeModal('debtsModal')" class="btn-action btn-outline" style="margin-top:15px">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
    </div>

    <datalist id="namesList"></datalist>

    <div id="settingsModal" class="modal"><div class="modal-content"><h3 style="text-align:center">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h3><input id="newE" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ø§Ù…Ù„"><input id="newR" type="number" placeholder="Ø§Ù„Ø£Ø¬Ø±"><button onclick="addWorker()" class="btn-action btn-blue">â• Ø¥Ø¶Ø§ÙØ©</button><div id="workersList" style="margin-top:15px"></div><button onclick="closeModal('settingsModal')" class="btn-action btn-outline" style="margin-top:10px">Ø¥ØºÙ„Ø§Ù‚</button></div></div>

    <div id="loginModal" class="modal" style="display:flex"><div class="modal-content" style="text-align:center"><h2>ğŸ”’</h2><p>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p></div></div>

    <script type="module" src="script.js"></script>
</body>
</html>
